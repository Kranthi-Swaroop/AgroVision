import{r as s,a as N,u as v,d as w,e as b,j as e,m as c}from"./index-Cj3VdF-t.js";const k=t=>t>=.8?"bg-danger":t>=.6?"bg-orange-500":t>=.4?"bg-yellow-500":"bg-success",p=t=>(typeof t=="number"?new Date(t):new Date(t)).toLocaleDateString("en-IN",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),S=s.memo(({record:t,index:a,t:l})=>{var o;return e.jsx(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:a*.05},className:"bg-secondary p-4 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${k(t.risk_score||0)}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium truncate",children:t.display_name||((o=t.disease)==null?void 0:o.replace(/_/g," "))||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-500",children:p(t.timestamp||t.created_at)}),t.remedy&&e.jsx("p",{className:"text-xs text-gray-400 mt-2 line-clamp-2",children:t.remedy.spray})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[((t.confidence||0)*100).toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:l("results.confidence")})]})]})})});s.memo(({record:t,index:a})=>e.jsx(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:a*.05},className:"bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-500/20 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-yellow-500 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-yellow-500",children:"Pending Scan"}),e.jsx("p",{className:"text-xs text-gray-500",children:p(t.timestamp)})]})]})}));function L(){const{location:t,setLocation:a}=N(),{t:l,language:o}=v(),[d,f]=s.useState([]),[C,H]=s.useState([]),[x,m]=s.useState(!1),[i,j]=s.useState(0);s.useEffect(()=>{t||!navigator.geolocation||navigator.geolocation.getCurrentPosition(n=>a({latitude:n.coords.latitude,longitude:n.coords.longitude}),()=>a({latitude:23.2599,longitude:77.4126}))},[t,a]);const u=s.useCallback(async()=>{m(!0);try{const n=await w(50);f(n);const r=await b();j(r)}catch(n){console.error("Failed to load history:",n)}m(!1)},[]);s.useEffect(()=>{u()},[u]);const g={en:"No scans yet",hi:"अभी तक कोई स्कैन नहीं",te:"ఇంకా స్కాన్‌లు లేవు",ta:"இன்னும் ஸ்கேன்கள் இல்லை",kn:"ಇನ್ನೂ ಸ್ಕ್ಯಾನ್‌ಗಳಿಲ್ಲ"},h={en:"Start scanning to build your history",hi:"अपना इतिहास बनाने के लिए स्कैनिंग शुरू करें",te:"మీ చరిత్రను నిర్మించడానికి స్కాన్ చేయడం ప్రారంభించండి",ta:"உங்கள் வரலாற்றை உருவாக்க ஸ்கேன் செய்யத் தொடங்குங்கள்",kn:"ನಿಮ್ಮ ಇತಿಹಾಸವನ್ನು ನಿರ್ಮಿಸಲು ಸ್ಕ್ಯಾನ್ ಮಾಡಲು ಪ್ರಾರಂಭಿಸಿ"},y={en:`${i} scan${i>1?"s":""} waiting to sync`,hi:`${i} स्कैन सिंक होने की प्रतीक्षा में`,te:`${i} స్కాన్‌లు సమకాలీకరణ కోసం వేచి ఉన్నాయి`,ta:`${i} ஸ்கேன்கள் ஒத்திசைக்க காத்திருக்கின்றன`,kn:`${i} ಸ್ಕ್ಯಾನ್‌ಗಳು ಸಿಂಕ್ ಮಾಡಲು ಕಾಯುತ್ತಿವೆ`};return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-xl font-bold mb-4",children:l("history.title")}),i>0&&e.jsxs(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 bg-yellow-500/20 border border-yellow-500/30 rounded-xl flex items-center gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-500 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"text-sm text-yellow-500",children:y[o]||y.en})]}),x&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-2 border-accent border-t-transparent rounded-full animate-spin"})}),!x&&d.length===0&&i===0&&e.jsxs("div",{className:"bg-secondary rounded-xl p-8 text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-secondary-color mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-secondary-color",children:g[o]||g.en}),e.jsx("p",{className:"text-xs text-secondary-color mt-1",children:h[o]||h.en})]}),e.jsx("div",{className:"space-y-3",children:d.map((n,r)=>e.jsx(S,{record:n,index:r,t:l},n.id||r))})]})}const D=s.memo(L);export{D as default};
